#:import to_rgba kivy.utils.get_color_from_hex


<MainMenu>:
    canvas.before:
        Color:
            rgba: to_rgba("F5F5F5")
        Rectangle:
            pos: self.pos
            size: self.size

    GridLayout:
        rows: 2

        BoxLayout:
            orientation: "vertical"
            Label:

            Image:
                source: "data/icons/logo.gif"

            Label:

        BoxLayout:
            orientation: "horizontal"
            cols: 3

            Label:

            GridLayout:
                rows: 5
                row_force_default: True
                row_default_height: 50
                spacing: [10, 10]

                Button:
                    text: "Start"
                    on_press:
                        root.ready_game()
                        root.manager.current = "discussion"

                Button:
                    text: "Settings"
                    on_press: app.open_settings()

                Button:
                    text: "Tutorial"
                    on_press: root.manager.current = "tutorial"

                Button:
                    text: "Credits"
                    on_press: root.manager.current = "credits"

                Button:
                    text: "Exit"
                    on_press: exit()

            Label:


<Tutorial>:
    # TODO: Write out the tutorial.


<Credits>:
    # TODO: Write out the credits.


<Discussion>:
    action_text: ""
    mafia_text: ""
    FloatLayout:
        canvas.before:
            Color:
                rgba: to_rgba("F5F5F5")
            Rectangle:
                pos: self.pos
                size: self.size

        Label:
#            canvas.before:
#                Color:
#                    rgba: to_rgba("05F5F0")
#                Rectangle:
#                    pos: self.pos
#                    size: self.size
            text: root.action_text
            text_size: self.size
            halign: 'left'
            valign: 'top'
            markup: True
            color: to_rgba("212121")
            pos: (0, root.height-self.height)
            size_hint: .2, 1

        Label:
#            canvas.before:
#                Color:
#                    rgba: to_rgba("05F5F0")
#                Rectangle:
#                    pos: self.pos
#                    size: self.size
            text: root.mafia_text
            text_size: self.size
            halign: 'right'
            valign: 'top'
            markup: True
            color: to_rgba("212121")
            pos: (root.width-self.width, root.height-self.height)
            size_hint: .2, .3

        ImageButton:
            id: submit_button
            pos: [root.center_x - self.width/2, root.center_y - self.height/2]
            source: "data/icons/submit_complete.png"
            size_hint: None, None
            size: "135dp", "135dp"
            on_press: root.submit()

        CircularLayout:
            id: circular_layout
            pos: [root.center_x - self.width/2, root.center_y - self.height/2]
            size_hint_y: 0.7
            start_angle: -180/len(self.children)-90 if len(self.children) else 0
            inner_radius_hint: 0.7
            outer_radius_hint: 1.2
            direction: "cw"


<Trial>:
    AnchorLayout:
        canvas.before:
            Color:
                rgba: to_rgba("F44336")
            Rectangle:
                pos: self.pos
                size: self.size

        ImageButton:
            id: submit_button
            size_hint: None, None
            size: "135dp", "135dp"
            source: "data/icons/submit_complete.png"
            on_press: root.submit()

        CircularLayout:
            id: circular_layout
            size_hint_y: 0.7
            start_angle: -180/len(self.children)-90 if len(self.children) else 0
            inner_radius_hint: 0.7
            outer_radius_hint: 1.2
            direction: "cw"


<Night>:
    AnchorLayout:
        canvas.before:
            Color:
                rgba: to_rgba("2196F3")
            Rectangle:
                pos: self.pos
                size: self.size

        ImageButton:
            id: submit_button
            source: "data/icons/submit_complete.png"
            size_hint: None, None
            size: "135dp", "135dp"
            on_press: root.submit()

        CircularLayout:
            id: circular_layout
            size_hint_y: 0.7
            start_angle: -180/len(self.children)-90 if len(self.children) else 0
            inner_radius_hint: 0.7
            outer_radius_hint: 1.2
            direction: "cw"


<GameOverMenu>:
    text: "[b]{} wins![/b]"
    canvas.before:
        Color:
            rgba: to_rgba("F5F5F5")
        Rectangle:
            pos: self.pos
            size: self.size

    BoxLayout:
        orientation: "vertical"

        BoxLayout:
            orientation: "vertical"

            Label:

            ImageButton:
                source: "data/icons/player_alive.png"
                on_press:
                    if self.source == "data/icons/player_alive.png": self.source = "data/icons/player_alive_old.png"
                    else: self.source = "data/icons/player_alive.png"
            Label:
                color: to_rgba("212121")
                text: root.text
                markup: True

        BoxLayout:
            orientation: "horizontal"
            cols: 3

            Label:

            GridLayout:
                rows: 4
                row_force_default: True
                row_default_height: 50
                spacing: [10, 10]

                Label:

                Button:
                    text: "Restart"
                    on_press:
                        root.ready_game()
                        root.manager.current = "discussion"

                Button:
                    text: "Main Menu"
                    on_press: root.manager.current = "mainmenu"

                Button:
                    text: "Exit"
                    on_press: exit()

            Label:


<LoadingScreen>:
    canvas.before:
        Color:
            rgba: to_rgba("F5F5F5")
        Rectangle:
            pos: self.pos
            size: self.size

    BoxLayout:
        Image:
            source: "data/icons/loading.gif"
#            color: to_rgba("212121")
#            text: "Loading..."
